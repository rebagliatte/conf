<% if current_edition.promo_video_uid.present? %>
  <%= video_embed_code(current_edition.promo_video_provider, current_edition.promo_video_uid) %>
<% end %>

<section class="intro">
  <h1 class="primary-heading"><%= current_conference.name %></h1>
  <p><%= current_edition.tagline %></p>
  <p><%= pretty_date_and_location(current_edition) %></p>
  <% if current_edition.registration_url.present? %>
    <%= link_to 'Register', current_edition.registration_url, class: 'btn btn-primary' %>
  <% end %>
</section>

<section id="location">
  <h1 class="primary-heading"><%= t('location') %></h1>
  <p><%= current_edition.location %></p>
  <div id="map-canvas"></div>
</section>

<section id="news">
  <%= render(partial: 'posts/list', locals: { posts: @posts, conference_edition: current_edition }) %>
</section>

<% if current_edition.previous_editions.any? %>
  <section id="previous-editions">
    <h1 class="primary-heading"><%= t('previous_editions') %></h1>
    <%= render(partial: 'conference_editions/list', locals: { conference_editions: current_edition.previous_editions }) %>
  </section>
<% end %>

<% if current_edition.coming_soon? %>
  <section id="call-for-proposals">
    <h1 class="primary-heading"><%= t('call_for_proposals') %></h1>
    <p><%= t('do_not_miss_out') %></p>
    <%= link_to t('submit_your_proposal'), new_conference_edition_talk_path(current_edition), class:'btn btn-primary' %>
  </section>

  <% if current_edition.sponsorship_packages_pdf %>
    <section id="sponsorship-packages">
      <h1 class="primary-heading"><%= t('sponsorship_packages') %></h1>
      <p><%= t('show_your_support_to') %> <%= current_conference.name %></p>
      <%= link_to t('download_sponsorship_packages'), current_edition.sponsorship_packages_pdf.url, class:'btn btn-primary', target: :blank %>
    </section>
  <% end %>
<% end %>

<% if current_edition.live? %>
  <%= render(partial: 'slots/schedule', locals: { conference_edition: current_edition }) %>
<% end %>

<% content_for :head_js do %>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
  <script>
    var geocoder;
    var map;

    function initialize() {
      geocoder = new google.maps.Geocoder();
      var mapOptions = {
        zoom: 13
      }
      map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
      codeAddress('<%= current_edition.location %>');
    }

    function codeAddress(address) {
      geocoder.geocode( { 'address': address}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          map.setCenter(results[0].geometry.location);
          var marker = new google.maps.Marker({
              map: map,
              position: results[0].geometry.location,
              title: address
          });
        } else {
          alert('Geocode was not successful for the following reason: ' + status);
        }
      });
    }

    google.maps.event.addDomListener(window, 'load', initialize);
  </script>
<% end %>
